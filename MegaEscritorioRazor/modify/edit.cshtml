@{
    <link href="~/assets/css/bootstrap-theme.css" rel="stylesheet" />
    <link href="~/assets/css/bootstrap.css" rel="stylesheet" />
    <link href="~/assets/css/main.css" rel="stylesheet" />

    var name = "";
    var width = "";
    var length = "";
    var materialType ="";
    var numOfDrawers = "";
    var rushOrderDays = "";
    var surfacePrice = "";
    var surfaceUpgrade = "";
    var shippingPrice = "";
    var surfaceArea = "";
    var price = "";
    var id = "";

    if (!IsPost)
    {
        if (!Request.QueryString["ID"].IsEmpty() && Request.QueryString["ID"].IsInt())
        {
            id = Request.QueryString["ID"];
            var db = Database.Open("Orders");
            var dbCommand = "SELECT * FROM Orders2 WHERE ID = @0";
            var row = db.QuerySingle(dbCommand, id);
            if (row != null)
            {
                name = row.Name;
                width = row.Width;
                length = row.Length;
                materialType = row.MaterialType;
                numOfDrawers = row.NumDrawers;
                rushOrderDays = row.RushDays;
                price = row.Price;
            }
            else
            {
                Validation.AddFormError("No order was found for that ID.");
            }
        }
        else
        {
            Validation.AddFormError("No order was selected.");
        }
    }

    if (IsPost)
    {
        Validation.RequireField("name", "Name is required.");
        Validation.RequireField("width", "Width is required.");
        Validation.RequireField("length", "Length is required.");
        Validation.RequireField("id", "Where's the order ID?");

        name = Request.Form["name"];
        width = Request.Form["width"];
        length = Request.Form["length"];
        materialType = Request.Form["getMaterial"];
        numOfDrawers = Request.Form["getDrawers"];
        rushOrderDays = Request.Form["getDays"];
        id = Request.Form["id"];

        if (Validation.IsValid())
        {

            //We'll need to do some recalculating here for the final price

            var db = Database.Open("Orders");
            var updateCommand = "UPDATE Orders2 SET Name=@0, Width=@2, Length=@3, NumDrawers=@4, MaterialType=@5, RushDays=@6, Price=@7 WHERE Id=@8";
            db.Execute(updateCommand, name, width, length, numOfDrawers, materialType, rushOrderDays, price, id);
            Response.Redirect("~/index/view-orders");
        }
    }
}



@section header {
    <header>
        <h1>Edit</h1>
    </header>
}

<form id="edit-entry" method="post">
    @Html.ValidationSummary()
    <h4>Base Desk Price: $200</h4>
    <div class="form-group">
        <label>Name:</label>
        <input class="form-control" name="Name" type="text" size="20" value="@name" />

    </div>
    <div class="form-group">
        <label>Width:</label>
        <input class="form-control" name="Width" type="text" size="20" value="@width" />

    </div>
    <div class="form-group">
        <label>Length:</label>
        <input class="form-control" name="Length" type="text" size="20" value="@length" />

    </div>

   <!-- need to figure out how to pre-set these values to the correct ones for the id -->

    <div class="form-group">
        <label>Desk Material:</label>
        <select class="form-control" name="getMaterial">
            <option value="pine" @(materialType == "pine" ? "selected" : "")>Pine - $50</option>
            <option value="poplar" @(materialType == "poplar" ? "selected" : "")>Poplar - $75</option>
            <option value="laminate" @(materialType == "laminate" ? "selected" : "")>Laminate - $100</option>
            <option value="oak" @(materialType == "oak" ? "selected" : "")>Oak - $200</option>
            <option value="alder" @(materialType == "alder" ? "selected" : "")>Alder - $250</option>
        </select>
    </div>
    <div class="form-group">
        <label>Number Of Drawers:</label>
        <select class="form-control" name="getDrawers">
            <option value="zero" @(numOfDrawers == "zero" ? "selected" : "")>0</option>
            <option value="one" @(numOfDrawers == "one" ? "selected" : "")>1 - $50</option>
            <option value="two" @(numOfDrawers == "two" ? "selected" : "")>2 - $100</option>
            <option value="three" @(numOfDrawers == "three" ? "selected" : "")>3 - $150</option>
            <option value="four" @(numOfDrawers == "four" ? "selected" : "")>4 - $200</option>v
            <option value="five" @(numOfDrawers == "five" ? "selected" : "")>5 - $250</option>
            <option value="six" @(numOfDrawers == "six" ? "selected" : "")>6 - $300</option>
            <option value="seven" @(numOfDrawers == "seven" ? "selected" : "")>7 - $350</option>
        </select>
    </div>
    <div class="form-group">
        <label>Shipping Days:</label>
        <select class="form-control" name="getDays">
            <option value="three" @(rushOrderDays == "three" ? "selected" : "")>3 days</option>
            <option value="five" @(rushOrderDays == "five" ? "selected" : "")>5 days</option>
            <option value="seven" @(rushOrderDays == "seven" ? "selected" : "")>7 days</option>
            <option value="ground" @(rushOrderDays == "fourteen" ? "selected" : "")>14 days</option>
        </select>
    </div>
    <div class="button-group">
        <a href="~/index/display-orders" class="btn btn-default">Cancel</a>
        <button type="submit" class="btn btn-primary">Submit Changes</button>
    </div>
</form>